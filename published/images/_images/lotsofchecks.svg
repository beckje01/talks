<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="280px" preserveAspectRatio="none" style="width:487px;height:280px;" version="1.1" viewBox="0 0 487 280" width="487px" zoomAndPan="magnify"><defs><filter height="300%" id="fqglpowxil77k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--entity client--><rect fill="#FEFECE" filter="url(#fqglpowxil77k)" height="36.2969" style="stroke: #000000; stroke-width: 1.5;" width="59" x="17" y="8"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="27" y="30.9951">Client</text><!--entity edge--><rect fill="#FEFECE" filter="url(#fqglpowxil77k)" height="36.2969" style="stroke: #000000; stroke-width: 1.5;" width="81" x="6" y="136"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="16" y="158.9951">API Edge</text><!--entity internal--><rect fill="#FEFECE" filter="url(#fqglpowxil77k)" height="36.2969" style="stroke: #000000; stroke-width: 1.5;" width="132" x="122.5" y="136"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="132.5" y="158.9951">Location Service</text><!--entity internal2--><rect fill="#FEFECE" filter="url(#fqglpowxil77k)" height="36.2969" style="stroke: #000000; stroke-width: 1.5;" width="121" x="290" y="136"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="300" y="158.9951">Device Service</text><!--entity internal3--><rect fill="#FEFECE" filter="url(#fqglpowxil77k)" height="36.2969" style="stroke: #000000; stroke-width: 1.5;" width="111" x="208" y="233"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="218" y="255.9951">State System</text><!--entity auth--><rect fill="#FEFECE" filter="url(#fqglpowxil77k)" height="36.2969" style="stroke: #000000; stroke-width: 1.5;" width="100" x="250.5" y="8"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="260.5" y="30.9951">Auth Server</text><!--link client to edge--><path d="M46.5,44.0678 C46.5,66.7142 46.5,105.5779 46.5,130.5114 " fill="none" id="client-edge" style="stroke: #0000FF; stroke-width: 2.0;"/><polygon fill="#0000FF" points="46.5,135.6096,50.5,126.6096,46.5,130.6096,42.5,126.6096,46.5,135.6096" style="stroke: #0000FF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="47.5" y="87.0669">Opaque</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="53.5" y="102.1997">Token</text><!--link edge to internal--><path d="M87.2695,154 C97.2593,154 107.2491,154 117.2389,154 " fill="none" id="edge-internal" style="stroke: #0000FF; stroke-width: 2.0;"/><polygon fill="#0000FF" points="122.4629,154,113.4629,150,117.4629,154,113.4629,158,122.4629,154" style="stroke: #0000FF; stroke-width: 1.0;"/><!--link internal to internal2--><path d="M254.6289,154 C264.6213,154 274.6138,154 284.6062,154 " fill="none" id="internal-internal2" style="stroke: #0000FF; stroke-width: 2.0;"/><polygon fill="#0000FF" points="289.8316,154,280.8316,150,284.8316,154,280.8316,158,289.8316,154" style="stroke: #0000FF; stroke-width: 1.0;"/><!--link edge to internal3--><path d="M86.8075,172.0176 C124.1438,188.7071 179.5974,213.4952 218.3944,230.8376 " fill="none" id="edge-internal3" style="stroke: #0000FF; stroke-width: 2.0;"/><polygon fill="#0000FF" points="223.0408,232.9145,216.4567,225.59,218.4761,230.8741,213.192,232.8935,223.0408,232.9145" style="stroke: #0000FF; stroke-width: 1.0;"/><!--link auth to edge--><path d="M246.7242,45.9654 C226.3204,54.0352 203.0579,63.8394 182.5,74 C143.9447,93.0556 101.5284,118.8275 74.488,135.9105 " fill="none" id="auth-edge" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="251.5734,44.0588,241.7339,43.6297,246.9202,45.8885,244.6614,51.0748,251.5734,44.0588" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="183.5" y="94.5669">Check</text><!--link auth to internal--><path d="M281.3355,47.9023 C259.698,72.6308 224.8748,112.4288 204.5916,135.6096 " fill="none" id="auth-internal" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="284.6907,44.0678,275.7538,48.2069,281.3981,47.8306,281.7744,53.475,284.6907,44.0678" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="258.5" y="94.5669">Check</text><!--link auth to internal2--><path d="M309.416,48.825 C319.098,73.611 334.3731,112.715 343.3163,135.6096 " fill="none" id="auth-internal2" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="307.5577,44.0678,307.1066,53.9063,309.377,48.7251,314.5582,50.9955,307.5577,44.0678" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="331.5" y="94.5669">Check</text><!--link internal3 to auth--><path d="M319.0253,240.4356 C357.0016,230.0077 404.6319,209.8906 428.5,172 C459.5683,122.6791 390.2625,73.3733 342.0078,46.5657 " fill="none" id="internal3-auth" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="337.4077,44.0424,343.3747,51.8779,341.7914,46.4471,347.2222,44.8639,337.4077,44.0424" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="436.5" y="158.5669">Check</text><!--
@startuml
  rectangle client as "Client"
  rectangle edge as "API Edge"
  rectangle internal as "Location Service"
  rectangle internal2 as "Device Service"
  rectangle internal3 as "State System"
  rectangle auth as "Auth Server"

  client -[#blue,bold]down-> edge: Opaque\nToken
  edge -[#blue,bold]> internal
  internal -[#blue,bold]> internal2
  edge -[#blue,bold]-> internal3

  edge -up-> auth: Check
  internal -up-> auth: Check
  internal2 -up-> auth: Check
  internal3 -> auth: Check


@enduml

PlantUML version 1.2018.13(Mon Nov 26 11:11:51 CST 2018)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_202-b05
Operating System: Linux
OS Version: 5.1.1-2-MANJARO
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>